import tensorflow as tf
from tensorflow.keras import layers, models
from tensorflow.keras.datasets import fashion_mnist from sklearn.model_selection import train_test_split from sklearn.preprocessing import StandardScaler import matplotlib.pyplot as plt

# Load and preprocess the Fashion MNIST dataset (train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()

# Normalize pixel values to be between 0 and 1
train_images, test_images = train_images / 255.0, test_images / 255.0
# Flatten the images to one-dimensional arrays train_images = train_images.reshape((60000, 28 * 28))
test_images = test_images.reshape((10000, 28 * 28))

# Split the data into training and validation sets
train_images, val_images, train_labels, val_labels = train_test_split( train_images, train_labels, test_size=0.2, random_state=42
)

# Standardize the features scaler = StandardScaler()
train_images = scaler.fit_transform(train_images) val_images = scaler.transform(val_images) test_images = scaler.transform(test_images)

# Build the neural network model model = models.Sequential()
model.add(layers.Dense(128, activation='relu', input_shape=(28 * 28,))) model.add(layers.Dropout(0.2))
model.add(layers.Dense(10, activation='softmax'))

# Compile the model model.compile(optimizer='adam',
loss='sparse_categorical_crossentropy', metrics=['accuracy'])

# Train the model
history = model.fit(train_images, train_labels, epochs=10, validation_data=(val_images, val_labels))

# Evaluate the model on the test set
test_loss, test_acc = model.evaluate(test_images, test_labels) print(f'Test accuracy: {test_acc}')

# Plot the training and validation accuracy over epochs plt.plot(history.history['accuracy'], label='Training Accuracy') plt.plot(history.history['val_accuracy'], label='Validation Accuracy') plt.xlabel('Epochs')
plt.ylabel('Accuracy')
plt.legend()
plt.show()

def display_images(images, labels, predictions=None): plt.figure(figsize=(10, 4))

for i in range(5):
# Displaying 5 examples 
plt.subplot(2, 5, i + 1)
plt.imshow(images[i].reshape(28, 28), cmap='gray')
plt.title(f"Digit: {np.argmax(labels[i])}") plt.axis('off')

if predictions is not None: plt.subplot(2, 5, i + 6) plt.bar(range(10), predictions[i])
plt.title(f"Prediction: {np.argmax(predictions[i])}") plt.xticks(range(10))

plt.show() display_images(test_images, test_labels)

subset_indices = np.random.choice(len(test_images), size=5, replace=False)
subset_images = test_images[subset_indices] subset_labels = test_labels[subset_indices] predictions = model.predict(subset_images)

display_images(subset_images, subset_labels, predictions)
